<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Prusa3d Marlin fork: Marlin main</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Prusa3d Marlin fork
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Marlin main</div>  </div>
</div><!--header-->
<div class="contents">

<p>Calibrate XYZ.  
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">onlyZ</td><td>if true, calibrate only Z axis </td></tr>
    <tr><td class="paramname">verbosity_level</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">true</td><td>Succeeded </td></tr>
    <tr><td class="paramname">false</td><td>Failed </td></tr>
  </table>
  </dd>
</dl>
<p>Handling of unload when using MMU with M600 A fullscreen message showing "Unloading Filament x" should be shown on the LCD and LCD updates should be are disabled in the meantime.</p>
<p>load filament for mmu v2 </p><dl class="section user"><dt>nozzle_temp nozzle temperature to load filament </dt><dd></dd></dl>
<p>Get serial number from 32U2 processor</p>
<p>Typical format of S/N is:CZPX0917X003XC13518</p>
<p>Send command ;S to serial port 0 to retrieve serial number stored in 32U2 processor, reply is stored in *SN. Operation takes typically 23 ms. If no valid SN can be retrieved within the 250ms window, the function aborts and returns a general failure flag. The command will fail if the 32U2 processor is unpowered via USB since it is isolated from the rest of the electronics. In that case the value that is stored in the EEPROM should be used instead.</p>
<dl class="section return"><dt>Returns</dt><dd>0 on success </dd>
<dd>
1 on general failure</dd></dl>
<p>Detection of faulty RAMBo 1.1b boards equipped with bigger capacitors at the TACH_1 pin, which causes bad detection of print fan speed. Warning: This function is not to be used by ordinary users, it is here only for automated testing purposes, it may even interfere with other functions of the printer! You have been warned! The test idea is to measure the time necessary to charge the capacitor. So the algorithm is as follows:</p><ol type="1">
<li>Set TACH_1 pin to INPUT mode and LOW</li>
<li>Wait a few ms</li>
<li>disable interrupts and measure the time until the TACH_1 pin reaches HIGH Repeat 1.-3. several times Good RAMBo's times are in the range of approx. 260-320 us Bad RAMBo's times are approx. 260-1200 us So basically we are interested in maximum time, the minima are mostly the same. May be that's why the bad RAMBo's still produce some fan RPM reading, but not corresponding to reality</li>
</ol>
<p>Parse and process commands</p>
<p>look here for descriptions of G-codes: <a href="https://reprap.org/wiki/G-code">https://reprap.org/wiki/G-code</a></p>
<h2>Implemented Codes </h2>
<ul>
<li><em>This list is not updated. Current documentation is maintained inside the process_cmd function.</em></li>
</ul>
<p><br  />
 PRUSA CODES <br  />
 P F - Returns FW versions <br  />
 P R - Returns revision of printer</p>
<p><br  />
 G0 -&gt; G1 <br  />
 G1 - Coordinated Movement X Y Z E <br  />
 G2 - CW ARC <br  />
 G3 - CCW ARC <br  />
 G4 - Dwell S&lt;seconds&gt; or P&lt;milliseconds&gt; <br  />
 G10 - retract filament according to settings of M207 <br  />
 G11 - retract recover filament according to settings of M208 <br  />
 G28 - Home all Axes <br  />
 G29 - Detailed Z-Probe, probes the bed at 3 or more points. Will fail if you haven't homed yet. <br  />
 G30 - Single Z Probe, probes bed at current XY location. <br  />
 G31 - Dock sled (Z_PROBE_SLED only) <br  />
 G32 - Undock sled (Z_PROBE_SLED only) <br  />
 G80 - Automatic mesh bed leveling <br  />
 G81 - Print bed profile <br  />
 G90 - Use Absolute Coordinates <br  />
 G91 - Use Relative Coordinates <br  />
 G92 - Set current position to coordinates given</p>
<p><br  />
 M Codes <br  />
 M0 - Unconditional stop - Wait for user to press a button on the LCD <br  />
 M1 - Same as M0 <br  />
 M17 - Enable/Power all stepper motors <br  />
 M18 - Disable all stepper motors; same as M84 <br  />
 M20 - List SD card <br  />
 M21 - Init SD card <br  />
 M22 - Release SD card <br  />
 M23 - Select SD file (M23 filename.g) <br  />
 M24 - Start/resume SD print <br  />
 M25 - Pause SD print <br  />
 M26 - Set SD position in bytes (M26 S12345) <br  />
 M27 - Report SD print status <br  />
 M28 - Start SD write (M28 filename.g) <br  />
 M29 - Stop SD write <br  />
 M30 - Delete file from SD (M30 filename.g) <br  />
 M31 - Output time since last M109 or SD card start to serial <br  />
 M32 - Select file and start SD print (Can be used <em>while</em> printing from SD card files): syntax "M32 /path/filename#", or "M32 S&lt;startpos bytes&gt; !filename#" Call gcode file : "M32 P !filename#" and return to caller file after finishing (similar to #include). The '#' is necessary when calling from within sd files, as it stops buffer prereading <br  />
 M42 - Change pin status via gcode Use M42 Px Sy to set pin x to value y, when omitting Px the onboard led will be used. <br  />
 M73 - Show percent done and print time remaining <br  />
 M80 - Turn on Power Supply <br  />
 M81 - Turn off Power Supply <br  />
 M82 - Set E codes absolute (default) <br  />
 M83 - Set E codes relative while in Absolute Coordinates (G90) mode <br  />
 M84 - Disable steppers until next move, or use S&lt;seconds&gt; to specify an inactivity timeout, after which the steppers will be disabled. S0 to disable the timeout. <br  />
 M85 - Set inactivity shutdown timer with parameter S&lt;seconds&gt;. To disable set zero (default) <br  />
 M86 - Set safety timer expiration time with parameter S&lt;seconds&gt;; M86 S0 will disable safety timer <br  />
 M92 - Set axis_steps_per_unit - same syntax as G92 <br  />
 M104 - Set extruder target temp <br  />
 M105 - Read current temp <br  />
 M106 - Fan on <br  />
 M107 - Fan off <br  />
 M109 - Sxxx Wait for extruder current temp to reach target temp. Waits only when heating Rxxx Wait for extruder current temp to reach target temp. Waits when heating and cooling IF AUTOTEMP is enabled, S&lt;mintemp&gt; B&lt;maxtemp&gt; F&lt;factor&gt;. Exit autotemp by any M109 without F <br  />
 M112 - Emergency stop <br  />
 M113 - Get or set the timeout interval for Host Keepalive "busy" messages <br  />
 M114 - Output current position to serial port <br  />
 M115 - Capabilities string <br  />
 M117 - display message <br  />
 M119 - Output Endstop status to serial port <br  />
 M123 - Tachometer value <br  />
 M126 - Solenoid Air Valve Open (BariCUDA support by jmil) <br  />
 M127 - Solenoid Air Valve Closed (BariCUDA vent to atmospheric pressure by jmil) <br  />
 M128 - EtoP Open (BariCUDA EtoP = electricity to air pressure transducer by jmil) <br  />
 M129 - EtoP Closed (BariCUDA EtoP = electricity to air pressure transducer by jmil) <br  />
 M140 - Set bed target temp <br  />
 M150 - Set BlinkM Color Output R: Red&lt;0-255&gt; U(!): Green&lt;0-255&gt; B: Blue&lt;0-255&gt; over i2c, G for green does not work. <br  />
 M155 - Automatically send temperatures, fan speeds, position <br  />
 M190 - Sxxx Wait for bed current temp to reach target temp. Waits only when heating Rxxx Wait for bed current temp to reach target temp. Waits when heating and cooling <br  />
 M200 D&lt;millimeters&gt;- set filament diameter and set E axis units to cubic millimeters (use S0 to set back to millimeters). <br  />
 M201 - Set max acceleration in units/s^2 for print moves (M201 X1000 Y1000) <br  />
 M202 - Set max acceleration in units/s^2 for travel moves (M202 X1000 Y1000) Unused in Marlin!! <br  />
 M203 - Set maximum feedrate that your machine can sustain (M203 X200 Y200 Z300 E10000) in mm/sec <br  />
 M204 - Set default acceleration: S normal moves T filament only moves (M204 S3000 T7000) in mm/sec^2 also sets minimum segment time in ms (B20000) to prevent buffer under-runs and M20 minimum feedrate <br  />
 M205 - advanced settings: minimum travel speed S=while printing T=travel only, B=minimum segment time X= maximum xy jerk, Z=maximum Z jerk, E=maximum E jerk <br  />
 M206 - set additional homing offset <br  />
 M207 - set retract length S[positive mm] F[feedrate mm/min] Z[additional zlift/hop], stays in mm regardless of M200 setting <br  />
 M208 - set recover=unretract length S[positive mm surplus to the M207 S*] F[feedrate mm/sec] <br  />
 M209 - S&lt;1=true/0=false&gt; enable automatic retract detect if the slicer did not support G10/11: every normal extrude-only move will be classified as retract depending on the direction. <br  />
 M214 - Set Arc Parameters (Use M500 to store in eeprom) P&lt;MM_PER_ARC_SEGMENT&gt; S&lt;MIN_MM_PER_ARC_SEGMENT&gt; R&lt;MIN_ARC_SEGMENTS&gt; F&lt;ARC_SEGMENTS_PER_SEC&gt; <br  />
 M220 S&lt;factor in percent&gt;- set speed factor override percentage <br  />
 M221 S&lt;factor in percent&gt;- set extrude factor override percentage <br  />
 M226 P&lt;pin number&gt; S&lt;pin state&gt;- Wait until the specified pin reaches the state required <br  />
 M240 - Trigger a camera to take a photograph <br  />
 M250 - Set LCD contrast C&lt;contrast value&gt; (value 0..63) <br  />
 M280 - set servo position absolute. P: servo index, S: angle or microseconds <br  />
 M300 - Play beep sound S&lt;frequency Hz&gt; P&lt;duration ms&gt; <br  />
 M301 - Set PID parameters P I and D <br  />
 M302 - Allow cold extrudes, or set the minimum extrude S&lt;temperature&gt;. <br  />
 M303 - PID relay autotune S&lt;temperature&gt; sets the target temperature. (default target temperature = 150C) <br  />
 M304 - Set bed PID parameters P I and D <br  />
 M310 - Temperature model settings <br  />
 M400 - Finish all moves <br  />
 M401 - Lower z-probe if present <br  />
 M402 - Raise z-probe if present <br  />
 M404 - N&lt;dia in mm&gt; Enter the nominal filament width (3mm, 1.75mm ) or will display nominal filament width without parameters <br  />
 M405 - Turn on Filament Sensor extrusion control. Optional D&lt;delay in cm&gt; to set delay in centimeters between sensor and extruder <br  />
 M406 - Turn off Filament Sensor extrusion control <br  />
 M407 - Displays measured filament diameter <br  />
 M500 - stores parameters in EEPROM <br  />
 M501 - reads parameters from EEPROM (if you need reset them after you changed them temporarily). <br  />
 M502 - reverts to the default "factory settings". You still need to store them in EEPROM afterwards if you want to. <br  />
 M503 - print the current settings (from memory not from EEPROM) <br  />
 M509 - force language selection on next restart <br  />
 M540 - Use S[0|1] to enable or disable the stop SD card print on endstop hit (requires ABORT_ON_ENDSTOP_HIT_FEATURE_ENABLED) <br  />
 M552 - Set IP address <br  />
 M600 - Pause for filament change X[pos] Y[pos] Z[relative lift] E[initial retract] L[later retract distance for removal] <br  />
 M605 - Set dual x-carriage movement mode: S&lt;mode&gt; [ X&lt;duplication x-offset&gt; R&lt;duplication temp offset&gt; ] <br  />
 M860 - Wait for PINDA thermistor to reach target temperature. <br  />
 M861 - Set / Read PINDA temperature compensation offsets <br  />
 M900 - Set LIN_ADVANCE options, if enabled. See <a class="el" href="Configuration__adv_8h_source.html">Configuration_adv.h</a> for details. <br  />
 M907 - Set digital trimpot motor current using axis codes. <br  />
 M908 - Control digital trimpot directly. <br  />
 M350 - Set microstepping mode. <br  />
 M351 - Toggle MS1 MS2 pins directly.</p>
<p><br  />
 M928 - Start SD logging (M928 filename.g) - ended by M29 <br  />
 M999 - Restart after being stopped by error <br  />
<br  />
</p>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
